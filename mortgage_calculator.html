<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mortgage Calculator</title>
    <link rel="stylesheet" href="stylesheet.css">
    
    <script>
        /**
         * Calculates the mortgage based on user input.
         * Adds input validation, handles 0% interest as a special case
         * and avoids displaying NaN when inputs are invalid.
         */
        function calculateMortgage() {
            // Get user input
            var loanAmount = parseFloat(document.getElementById('loanAmount').value);
            var interestRate = parseFloat(document.getElementById('interestRate').value);
            var loanTerm = parseFloat(document.getElementById('loanTerm').value);

            var monthlyPaymentEl = document.getElementById('monthlyPayment');
            var totalPaymentEl = document.getElementById('totalPayment');
            var totalInterestEl = document.getElementById('totalInterest');

            function showError(msg) {
                monthlyPaymentEl.textContent = msg;
                totalPaymentEl.textContent = msg;
                totalInterestEl.textContent = msg;
            }

            // Basic validation
            if (!isFinite(loanAmount) || loanAmount <= 0) {
                showError('Invalid input');
                return;
            }
            if (!isFinite(interestRate) || interestRate < 0) {
                showError('Invalid input');
                return;
            }
            if (!isFinite(loanTerm) || loanTerm <= 0) {
                showError('Invalid input');
                return;
            }

            var monthlyInterestRate = interestRate / 100 / 12;
            var numberOfPayments = loanTerm * 12;
            var monthlyPayment;

            // Handle 0% interest (avoid division by zero)
            if (monthlyInterestRate === 0) {
                monthlyPayment = loanAmount / numberOfPayments;
            } else {
                monthlyPayment = (loanAmount * monthlyInterestRate) / (1 - Math.pow(1 + monthlyInterestRate, -numberOfPayments));
            }

            if (!isFinite(monthlyPayment)) {
                showError('Calculation error');
                return;
            }

            var totalPayment = monthlyPayment * numberOfPayments;
            var totalInterest = totalPayment - loanAmount;

            // Display the result with two decimals
            monthlyPaymentEl.textContent = monthlyPayment.toFixed(2);
            totalPaymentEl.textContent = totalPayment.toFixed(2);
            totalInterestEl.textContent = totalInterest.toFixed(2);
        }
    </script>
</head>
<body>
    <h1>Mortgage Calculator</h1>
    <p>All calculations are performed on the user's browser using JavaScript. No data is stored or transmitted back to the server. This ensures the privacy and security of your information.</p>
    <form>
        <label for="loanAmount">Loan Amount:</label>
        <input type="number" id="loanAmount" required><br>

        <label for="interestRate">Interest Rate (%):</label>
        <input type="number" id="interestRate" required><br>

        <label for="loanTerm">Loan Term (years):</label>
        <input type="number" id="loanTerm" required><br>

        <button type="button" onclick="calculateMortgage()">Calculate</button>
    </form>

    <h2>Result:</h2>
    <p>Monthly Payment: $<span id="monthlyPayment" role="status" aria-live="polite">--</span></p>
    <p>Total Payment: $<span id="totalPayment" role="status" aria-live="polite">--</span></p>
    <p>Total Interest: $<span id="totalInterest" role="status" aria-live="polite">--</span></p>
    <script src="/scripts/common.js"></script>
    <br>
    <script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="inputdrive22" data-color="#5F7FFF" data-emoji="ðŸ˜‰"  data-font="Bree" data-text="Buy me a coffee OR tea?" data-outline-color="#000000" data-font-color="#ffffff" data-coffee-color="#FFDD00" ></script>
    <a href="/index.html">Go to Home page</a><br>  
</body>
</html>